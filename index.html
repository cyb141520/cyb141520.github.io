<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="alternate" href="/rss.xml" title="此时相望不相闻，愿逐月华流照君" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="此时相望不相闻，愿逐月华流照君" type="application/atom+xml"><link rel="alternate" type="application/json" title="此时相望不相闻，愿逐月华流照君" href="https://cyb141520.github.io/feed.json"><link rel="preconnect" href="https://s4.zstatic.net"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext" media="none" onload="this.media='all'"><link rel="modulepreload" href="/js/siteInit.js"><link rel="modulepreload" href="/js/nyx-player-GAYVXOT2.js"><link rel="modulepreload" href="/js/copy-tex-ZB3YLK4M.js"><link rel="modulepreload" href="/js/post-IGXPDX6N.js"><link rel="modulepreload" href="/js/chunk-2MYORO2B.js"><link rel="modulepreload" href="/js/pagefind-U2ETNMP3.js"><link rel="modulepreload" href="/js/index.esm-LV2XXO35.js"><link rel="modulepreload" href="/js/chunk-HJSTZ4VX.js"><link rel="modulepreload" href="/js/chunk-QNA7Z54Y.js"><link rel="stylesheet" href="/css/siteInit.css" media="none" onload="this.media='all'"><link rel="preload" href="https://1on1.today/blog/wp-content/uploads/2021/04/%E7%82%BA%E4%BB%80%E9%BA%BC-%E6%9C%89%E6%B5%81%E6%98%9F-%E6%B5%81%E6%98%9F%E9%9B%A8-%E6%98%AF%E4%BB%80%E9%BA%BC-%E5%A6%82%E4%BD%95-%E7%94%A2%E7%94%9F.png" as="image" fetchpriority="high"><link rel="preload" href="https://sat.huijiwiki.com/wiki/%E6%96%87%E4%BB%B6:Shooting_star.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://pweb.cwa.gov.tw/PopularScience/images/02_SubjectMaterial/02_sky/02_sky_02/02_sky_02_S.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://starwalk.space/gallery/images/msdec-01/1140x641.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://sat.huijiwiki.com/wiki/%E6%96%87%E4%BB%B6:Shooting_star.jpg" as="image" fetchpriority="high"><link rel="canonical" href="https://cyb141520.github.io/"><link rel="stylesheet" href="/css/page.css?v=0.5.4"><title>vvwwv = 此时相望不相闻，愿逐月华流照君</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="pagefind_mount"></div><div id="container"><header id="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><a class="logo" href="/" rel="start"><p class="artboard">vvwwv</p><h1 class="title" itemprop="name headline">此时相望不相闻，愿逐月华流照君</h1></a></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">vvwwv</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://1on1.today/blog/wp-content/uploads/2021/04/%E7%82%BA%E4%BB%80%E9%BA%BC-%E6%9C%89%E6%B5%81%E6%98%9F-%E6%B5%81%E6%98%9F%E9%9B%A8-%E6%98%AF%E4%BB%80%E9%BA%BC-%E5%A6%82%E4%BD%95-%E7%94%A2%E7%94%9F.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://sat.huijiwiki.com/wiki/%E6%96%87%E4%BB%B6:Shooting_star.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://pweb.cwa.gov.tw/PopularScience/images/02_SubjectMaterial/02_sky/02_sky_02/02_sky_02_S.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://starwalk.space/gallery/images/msdec-01/1140x641.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://sat.huijiwiki.com/wiki/%E6%96%87%E4%BB%B6:Shooting_star.jpg&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="index wrap"><h2 class="divider">置顶文章</h2><div class="segments sticky"><article class="item"><div class="cover"><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap(2)/" itemprop="url" title="how2heap"><img loading="eager" decoding="async" src="https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-19 19:23:15"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-19T19:23:15+08:00">2023-10-19</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>14k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>13 分钟</span></span></div><h3><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap(2)/" itemprop="url" title="how2heap">how2heap</a></h3><div class="excerpt">本来想着一篇文章写完glibc2.23how2heap系列，但是太长了，还是分开写吧
# 6.house_of_gods【还没搞明白，先挖个坑】
# 7.house_of_lore
这个漏洞就是利用了申请samll bin后会将bk指到下个chunk上，如果这个chunk是我们想要控制的那么我们就可以申请回来然后利用，在要控制处伪造chunk，使他的fd指向small bin的chunk即可绕过检测（一开始在想既然能直接该想要修改处的值，还伪造干嘛；后面发现这里能改写但是无法getshell，伪造后能利用其返回的ret来getshell）
# 1.程序源码
/*
Advanced e</div><div class="meta footer"><span><a href="/categories/how2heap2-23/PWN%E4%B8%93%E6%A0%8F/" itemprop="url" title="PWN专栏"><i class="ic i-flag"></i>PWN专栏</a></span></div><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap(2)/" class="btn" itemprop="url" title="how2heap">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap/" itemprop="url" title="how2heap"><img loading="eager" decoding="async" src="https://pweb.cwa.gov.tw/PopularScience/images/02_SubjectMaterial/02_sky/02_sky_02/02_sky_02_S.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-19 19:23:15"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-19T19:23:15+08:00">2023-10-19</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>45k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>41 分钟</span></span></div><h3><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap/" itemprop="url" title="how2heap">how2heap</a></h3><div class="excerpt">图床迁移替换：
https://vvwwv.oss-cn-nanjing.aliyuncs.com/how2heap
换为
https://blog-vvwwvv.oss-cn-hangzhou.aliyuncs.com/how2heap
# 编译及链接
# 首先安装对应glibc版本
./download 2.23-0ubuntu3_amd64
# 编译程序
gcc  -g -no-pie fastbin_dup.c -o fastbin_dup
【这里-g是可以根据代码对应的行数来下断点】
# 链接对应版本的glibc库</div><div class="meta footer"><span><a href="/categories/how2heap2-23/PWN%E4%B8%93%E6%A0%8F/" itemprop="url" title="PWN专栏"><i class="ic i-flag"></i>PWN专栏</a></span></div><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap/" class="btn" itemprop="url" title="how2heap">more...</a></div></article></div><h2 class="divider">文章列表</h2><div class="segments posts"><article class="item"><div class="cover"><a href="/2025/08/06/pwn%E4%B8%93%E6%A0%8F/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E_new/" itemprop="url" title="格式化字符串"><img loading="lazy" decoding="async" src="https://images.sbs.com.au/dims4/default/2b3281c/2147483647/strip/true/crop/2862x1610+0+149/resize/1280x720!/quality/90/?url=http%3A%2F%2Fsbs-au-brightspot.s3.amazonaws.com%2F64%2F00%2F37bc52b54888b89fbc09ec1a962b%2F流星雨-20250418140862710179-original.jpg&amp;imwidth=1280" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2025-08-06 19:23:15"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2025-08-06T19:23:15+08:00">2025-08-06</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>6.6k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>6 分钟</span></span></div><h3><a href="/2025/08/06/pwn%E4%B8%93%E6%A0%8F/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E_new/" itemprop="url" title="格式化字符串">格式化字符串</a></h3><div class="excerpt"># 格式化字符串函数介绍
参考ctf wiki：
格式化字符串函数可以接受可变数量的参数，并将第一个参数作为格式化字符串（也就是格式参数说明符,例如%s、%c），根据其来解析之后的参数。通俗来说，格式化字符串函数就是将计算机内存中表示的数据转化为我们人类可读的字符串格式。几乎所有的 C/C++ 程序都会利用格式化字符串函数来输出信息，调试程序，或者处理字符串。一般来说，格式化字符串在利用的时候主要分为三个部分:

格式化字符串函数
格式化字符串
后续参数，可选

例子：（这个例子中在第一个参数中设立了三个格式参数说明符，将后续的三个参数按相应格式进行转化）

# 格式化字符串函数
常</div><div class="meta footer"><span><a href="/categories/CTF/%E4%B8%93%E6%A0%8F/" itemprop="url" title="专栏"><i class="ic i-flag"></i>专栏</a></span></div><a href="/2025/08/06/pwn%E4%B8%93%E6%A0%8F/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E_new/" class="btn" itemprop="url" title="格式化字符串">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/10/07/pwn%E4%B8%93%E6%A0%8F/FORTIFY/" itemprop="url" title="FORTIFY_SOURCE（例题：CTFshow的pwn32）"><img loading="lazy" decoding="async" src="https://sat.huijiwiki.com/wiki/文件:Shooting_star.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-07 14:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-07T14:15:56+08:00">2023-10-07</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>1.3k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>1 分钟</span></span></div><h3><a href="/2023/10/07/pwn%E4%B8%93%E6%A0%8F/FORTIFY/" itemprop="url" title="FORTIFY_SOURCE（例题：CTFshow的pwn32）">FORTIFY_SOURCE（例题：CTFshow的pwn32）</a></h3><div class="excerpt"># 1.简介（在编译时进行设置）：
fority是轻微的检测，用于检查缓冲区溢出的错误，在程序采用打量的字符串或者内存操作函数适用，例如：memcpy、memset、stpcpy、strcpy、strncpy、strncat、sprintf、snprintf、vsprintf、gets以及宽字符的变体。
# 2.作用：
FORTIFY_SOURCE 是一个 C/C++ 编译器提供的安全保护机制，旨在防止缓冲区溢出和其他与字符串和内存操作相关的安全漏洞。它是在编译时自动插入的一组额外代码，用于增强程序对于缓冲区溢出和其他常见安全问题的防护。FORTIFY_SOURCE 提供了以下主要功</div><div class="meta footer"><span><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/FORTIFY/" itemprop="url" title="FORTIFY"><i class="ic i-flag"></i>FORTIFY</a></span></div><a href="/2023/10/07/pwn%E4%B8%93%E6%A0%8F/FORTIFY/" class="btn" itemprop="url" title="FORTIFY_SOURCE（例题：CTFshow的pwn32）">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/10/05/pwn%E4%B8%93%E6%A0%8F/large_bin_attack/" itemprop="url" title="large bin attack（为house利用系列打下基础）"><img loading="lazy" decoding="async" src="https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-05 14:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-05T14:15:56+08:00">2023-10-05</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>6.2k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>6 分钟</span></span></div><h3><a href="/2023/10/05/pwn%E4%B8%93%E6%A0%8F/large_bin_attack/" itemprop="url" title="large bin attack（为house利用系列打下基础）">large bin attack（为house利用系列打下基础）</a></h3><div class="excerpt"># 1.Large bin
# 1.
在释放堆块时，想要进入large bin的堆块需要大于等于512（1024）字节【用户空间需要大于等于0x3F0，用户空间小于0x3F0进入small bin】
而largebin还要考虑fd_nextsiez和bk_nextsize，这两个是因为，在largebin中，会按着相同大小的chunk归到一起，不同chunk组直接的联系就需要fd_nextsize和bk_nextsize。这里除了每组的第一个chunk ，其他的fd_nextsize和bk_nextsize 都为0
fd_nextsize指向了下一组的第一个chunk
bk_nextsize指</div><div class="meta footer"><span><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/large-bin-attack/" itemprop="url" title="large bin attack"><i class="ic i-flag"></i>large bin attack</a></span></div><a href="/2023/10/05/pwn%E4%B8%93%E6%A0%8F/large_bin_attack/" class="btn" itemprop="url" title="large bin attack（为house利用系列打下基础）">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/10/04/pwn%E4%B8%93%E6%A0%8F/ASLR%E4%B8%8EPIE/" itemprop="url" title="ASLR与PIE（例题：CTFshow的pwn31）"><img loading="lazy" decoding="async" src="https://sat.huijiwiki.com/wiki/文件:Shooting_star.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-04 14:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-04T14:15:56+08:00">2023-10-04</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>1.7k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>2 分钟</span></span></div><h3><a href="/2023/10/04/pwn%E4%B8%93%E6%A0%8F/ASLR%E4%B8%8EPIE/" itemprop="url" title="ASLR与PIE（例题：CTFshow的pwn31）">ASLR与PIE（例题：CTFshow的pwn31）</a></h3><div class="excerpt"># 前言
ASLR与PIE是不同的，两者不能认为是同一个机制，但是他们都是对地址进行随机化，只不过作用的对象和作用时期不太一样
# 1.ASLR(操作系统的功能)：
ASLR是Linux操作系统的功能选项，作用于程序(ELF)装入内存运行时。是一种针对缓冲区溢出的安全保护技术，通过对加载地址的随机化，防止攻击者直接定位攻击代码位置，到达阻止溢出攻击的一种技术。
# 打开/关闭ASLR：
# 查看ASLR打开情况：
sudo cat /proc/sys/kernel/randomize_va_space
# 关闭ALSR
1.手动修改（长期生效）</div><div class="meta footer"><span><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/ASLR/" itemprop="url" title="ASLR"><i class="ic i-flag"></i>ASLR</a></span></div><a href="/2023/10/04/pwn%E4%B8%93%E6%A0%8F/ASLR%E4%B8%8EPIE/" class="btn" itemprop="url" title="ASLR与PIE（例题：CTFshow的pwn31）">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/10/01/pwn%E4%B8%93%E6%A0%8F/ret2dlresolve/" itemprop="url" title="高级ROP之ret2dlresolve"><img loading="lazy" decoding="async" src="https://sat.huijiwiki.com/wiki/文件:Shooting_star.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-10-01 14:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-10-01T14:15:56+08:00">2023-10-01</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>9k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>8 分钟</span></span></div><h3><a href="/2023/10/01/pwn%E4%B8%93%E6%A0%8F/ret2dlresolve/" itemprop="url" title="高级ROP之ret2dlresolve">高级ROP之ret2dlresolve</a></h3><div class="excerpt">【例题ctfshow pwn82】
# 1.用处：
在有溢出而无法泄露内容时可以利用ret2dlresolve来修改解析的函数，从而达到执行想要的函数的目的
# 2.原理：
程序通过动态链接来达到节省空间的目的，动态链接会有一个延迟绑定的特点，将连接的过程推迟到了程序运行时
动态链接中有个重要函数_dl_runtime_resolve(link_map_obj,reloc_index)来对动态链接的函数进行重定位
利用dl_resolve原因：
1、dl_resolve 函数不会检查对应的函数是否越界，它只会根据我们给定的数据来执行（也就是说其可以偏移到我们构造的地方）
2、dl_resolv</div><div class="meta footer"><span><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/%E6%A0%88%E6%BA%A2%E5%87%BA/" itemprop="url" title="栈溢出"><i class="ic i-flag"></i>栈溢出</a></span></div><a href="/2023/10/01/pwn%E4%B8%93%E6%A0%8F/ret2dlresolve/" class="btn" itemprop="url" title="高级ROP之ret2dlresolve">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/09/28/pwn%E4%B8%93%E6%A0%8F/%E6%A0%88%E8%BF%81%E7%A7%BB/" itemprop="url" title="栈迁移"><img loading="lazy" decoding="async" src="https://sat.huijiwiki.com/wiki/文件:Shooting_star.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-09-28 14:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-09-28T14:15:56+08:00">2023-09-28</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>1.7k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>2 分钟</span></span></div><h3><a href="/2023/09/28/pwn%E4%B8%93%E6%A0%8F/%E6%A0%88%E8%BF%81%E7%A7%BB/" itemprop="url" title="栈迁移">栈迁移</a></h3><div class="excerpt">（之前写的没保存，这是第二遍写，我要杀人...）
# 栈的结构

# 栈迁移的应用场景
栈迁移主要是为了解决栈溢出空间大小不足的问题，当我们的ROP链过长时很可能栈空间不够，并且ebp之前的空间其实只是填充一些没什么用的数据,所以需要一个新的地址空间来存放当前的payload
我们的栈
# 1. leave和ret命令
leave：
mov  esp , ebp
pop   ebp       #执行pop时，ebp出栈，并且将esp地址内的值放入ebp

这里要注意 mov esp,ebp是将ebp的地址付给esp，也就是说将esp从栈顶拉下来到ebp的位置，pop ebp是将esp内部的值</div><div class="meta footer"><span><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" itemprop="url" title="CTF"><i class="ic i-flag"></i>CTF</a></span></div><a href="/2023/09/28/pwn%E4%B8%93%E6%A0%8F/%E6%A0%88%E8%BF%81%E7%A7%BB/" class="btn" itemprop="url" title="栈迁移">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/DynELF/" itemprop="url" title="DynELF"><img loading="lazy" decoding="async" src="https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-08-29 20:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-08-29T20:15:56+08:00">2023-08-29</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>1.3k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>1 分钟</span></span></div><h3><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/DynELF/" itemprop="url" title="DynELF">DynELF</a></h3><div class="excerpt"># 概述
由于在pwn题中有时候不给libc，那么需要我们自己通过泄露函数地址来获得libc的基地址，而往往LibcSearcher无法准确的得到libc版本，那么我们就需要利用DynELF，这是pwntools在早期版本就提供了一个解决方案——DynELF类；利用方式与ret2libc类似，都是泄露函数地址来计算得到libc基址，通俗地讲，DynELF就是通过程序漏洞泄露出任意地址内容，结合ELF文件的结构特征获取对应版本文件并计算对比出目标符号在内存中的地址
并且：
write函数是最理想的，因为write函数的特点在于其输出完全由其参数size决定，只要目标地址可读，size填多少就输出</div><div class="meta footer"><span><a href="/categories/Linux/PWN%E4%B8%93%E6%A0%8F/CTF/DynELF/" itemprop="url" title="DynELF"><i class="ic i-flag"></i>DynELF</a></span></div><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/DynELF/" class="btn" itemprop="url" title="DynELF">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/%E6%B2%99%E7%9B%92%E6%9C%BA%E5%88%B6/" itemprop="url" title="沙盒机制"><img loading="lazy" decoding="async" src="https://1on1.today/blog/wp-content/uploads/2021/04/為什麼-有流星-流星雨-是什麼-如何-產生.png" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-08-29 20:15:56"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-08-29T20:15:56+08:00">2023-08-29</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>7k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>6 分钟</span></span></div><h3><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/%E6%B2%99%E7%9B%92%E6%9C%BA%E5%88%B6/" itemprop="url" title="沙盒机制">沙盒机制</a></h3><div class="excerpt"># 概述
沙盒机制也就是我们常说的沙箱，英文名sandbox，是计算机领域的虚拟技术，常见于安全方向。一般说来，我们会将不受信任的软件放在沙箱中运行，一旦该软件有恶意行为，则禁止该程序的进一步运行，不会对真实系统造成任何危害。
在ctf比赛中，pwn题中的沙盒一般都会限制execve的系统调用，这样一来one_gadget和system调用都不好使，只能采取open/read/write的组合方式来读取flag。当然有些题目可能还会将上面三个系统调用砍掉一个，进一步限制我们获取到flag.
# 1.prctl函数调用
prctl是进程管理函数，沙箱规则通过prctl函数实现</div><div class="meta footer"><span><a href="/categories/Linux/PWN%E4%B8%93%E6%A0%8F/CTF/%E6%B2%99%E7%9B%92/" itemprop="url" title="沙盒"><i class="ic i-flag"></i>沙盒</a></span></div><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/%E6%B2%99%E7%9B%92%E6%9C%BA%E5%88%B6/" class="btn" itemprop="url" title="沙盒机制">more...</a></div></article><article class="item"><div class="cover"><a href="/2023/08/24/pwn%E4%B8%93%E6%A0%8F/ret2csu/" itemprop="url" title="64位构造通用ROP，ret2csu"><img loading="lazy" decoding="async" src="https://starwalk.space/gallery/images/msdec-01/1140x641.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2023-08-24 19:23:15"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2023-08-24T19:23:15+08:00">2023-08-24</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>3.4k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>3 分钟</span></span></div><h3><a href="/2023/08/24/pwn%E4%B8%93%E6%A0%8F/ret2csu/" itemprop="url" title="64位构造通用ROP，ret2csu">64位构造通用ROP，ret2csu</a></h3><div class="excerpt"># ret2csu
# 原理

64位程序中，函数的前6个参数是通过寄存器传递的，但是大多数时候我们很难找到每个寄存器对应的gadges。这时候，我们可以利用x64下的__libc_csu_init中的gadgets。
这个函数是用来对libc进行初始化操作的，而一般的程序都会调用libc函数，所以这个函数一定会存在。

# 下面借用别人在IDA摘出来的__libc_csu_init函数的汇编指令
.text:00000000004011B0 ; void _libc_csu_init(void)
.text:00000000004011B0                 public __</div><div class="meta footer"><span><a href="/categories/CTF/PWN%E4%B8%93%E6%A0%8F/ROP/" itemprop="url" title="ROP"><i class="ic i-flag"></i>ROP</a></span></div><a href="/2023/08/24/pwn%E4%B8%93%E6%A0%8F/ret2csu/" class="btn" itemprop="url" title="64位构造通用ROP，ret2csu">more...</a></div></article><article class="item"><div class="cover"><a href="/2022/10/07/hello-world/" itemprop="url" title="Hello World"><img loading="lazy" decoding="async" src="https://starwalk.space/gallery/images/meteor-showers-landscape-1/1140x641.jpg" alt="article cover"></a></div><div class="info"><div class="meta"><span class="item" title="创建时间：2022-10-07 14:31:25"><span class="icon"><i class="ic i-calendar"></i></span><time itemprop="dateCreated datePublished" datetime="2022-10-07T14:31:25+08:00">2022-10-07</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span>811</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span>1 分钟</span></span></div><h3><a href="/2022/10/07/hello-world/" itemprop="url" title="Hello World">Hello World</a></h3><div class="excerpt">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
# Quick Start
# Create a new post
$ hexo new "My New Post"
More info: Writing
# Run server
$ he</div><a href="/2022/10/07/hello-world/" class="btn" itemprop="url" title="Hello World">more...</a></div></article></div></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"></div><div class="related panel pjax" data-title="系列文章"></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="vvwwv" src="/assets/avatar.avif"><p class="name" itemprop="name">vvwwv</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">12</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">18</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/yourname" class="item github" title="https://github.com/yourname"><i class="ic i-github"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div><div id="player"></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2022/10/07/hello-world/">Hello World</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/" title="分类于Linux">Linux</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/large-bin-attack/" title="分类于large bin attack">large bin attack</a></div><span><a href="/2023/10/05/pwn%E4%B8%93%E6%A0%8F/large_bin_attack/">large bin attack（为house利用系列打下基础）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/CTF/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/CTF/PWN%E4%B8%93%E6%A0%8F/ROP/" title="分类于ROP">ROP</a></div><span><a href="/2023/08/24/pwn%E4%B8%93%E6%A0%8F/ret2csu/">64位构造通用ROP，ret2csu</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/how2heap2-23/" title="分类于how2heap2.23">how2heap2.23</a><i class="ic i-angle-right"></i><a href="/categories/how2heap2-23/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a></div><span><a href="/2023/10/19/pwn%E4%B8%93%E6%A0%8F/how2heap(2)/">how2heap</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a></div><span><a href="/2023/09/28/pwn%E4%B8%93%E6%A0%8F/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="分类于Linux">Linux</a><i class="ic i-angle-right"></i><a href="/categories/Linux/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/Linux/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/Linux/PWN%E4%B8%93%E6%A0%8F/CTF/%E6%B2%99%E7%9B%92/" title="分类于沙盒">沙盒</a></div><span><a href="/2023/08/29/pwn%E4%B8%93%E6%A0%8F/%E6%B2%99%E7%9B%92%E6%9C%BA%E5%88%B6/">沙盒机制</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/CTF/%E4%B8%93%E6%A0%8F/" title="分类于专栏">专栏</a></div><span><a href="/2025/08/06/pwn%E4%B8%93%E6%A0%8F/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E_new/">格式化字符串</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/" title="分类于Linux">Linux</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/ASLR/" title="分类于ASLR">ASLR</a></div><span><a href="/2023/10/04/pwn%E4%B8%93%E6%A0%8F/ASLR%E4%B8%8EPIE/">ASLR与PIE（例题：CTFshow的pwn31）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/%E6%A0%88%E6%BA%A2%E5%87%BA/" title="分类于栈溢出">栈溢出</a></div><span><a href="/2023/10/01/pwn%E4%B8%93%E6%A0%8F/ret2dlresolve/">高级ROP之ret2dlresolve</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN%E4%B8%93%E6%A0%8F/" title="分类于PWN专栏">PWN专栏</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/" title="分类于CTF">CTF</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/" title="分类于Linux">Linux</a><i class="ic i-angle-right"></i><a href="/categories/PWN%E4%B8%93%E6%A0%8F/CTF/Linux/FORTIFY/" title="分类于FORTIFY">FORTIFY</a></div><span><a href="/2023/10/07/pwn%E4%B8%93%E6%A0%8F/FORTIFY/">FORTIFY_SOURCE（例题：CTFshow的pwn32）</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2></div></div><div class="status"><div class="copyright">© 2022 -<span itemprop="copyrightYear">2026</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">vvwwv @ vvwwv</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">98k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">1:29</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> &amp; Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config="" type="text/javascript">var LOCAL = {
    ispost: false,
    path: ``,
    favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    nocopy: "false",
    copyright: `复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。`,
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    }
};
</script><script src="/js/siteInit.js?v=0.5.4" type="module" fetchpriority="high" defer=""></script></body></html>