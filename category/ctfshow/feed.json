{
    "version": "https://jsonfeed.org/version/1",
    "title": "Blog • All posts by \"ctfshow\" category",
    "description": "",
    "home_page_url": "https://vvwwvv.cn",
    "items": [
        {
            "id": "https://vvwwvv.cn/2023/09/15/pwn/%E5%88%B7%E9%A2%98/ctfshow/ctfshow5-34/",
            "url": "https://vvwwvv.cn/2023/09/15/pwn/%E5%88%B7%E9%A2%98/ctfshow/ctfshow5-34/",
            "title": "CTFshow(前置基础部分-汇编,5~34)",
            "date_published": "2023-09-15T03:01:15.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzU2Njk2Mzc4L2FydGljbGUvZGV0YWlscy8xMjgwNjc0Mzg=\">https://blog.csdn.net/m0_56696378/article/details/128067438</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQUYlODQlRTUlQUQlOTglRTUlOTklQTglRTUlQUYlQkIlRTUlOUQlODAlRTYlOTYlQjklRTUlQkMlOEYvNjY4NjQwOA==\">https://baike.baidu.com/item/%E5%AF%84%E5%AD%98%E5%99%A8%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/6686408</span></p>\n<h1 id=\"pwn5\"><a class=\"anchor\" href=\"#pwn5\">#</a> pwn5</h1>\n<h2 id=\"题目\"><a class=\"anchor\" href=\"#题目\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfMr7t.png\" alt=\"\" /><br />\n查看查询信息（另一个 asm 文件是用于在 C<ins> 源码中内嵌汇编语言。ASM 能写在任何 C</ins> 合法语句中，asm 还不是 C 的标准关键字）</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfQC4K.png\" alt=\"\" /></p>\n<p>32 位程序，利用 ida 打开</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfQl8S.png\" alt=\"\" /></p>\n<p>发现是 int 0x80，为系统调用，通过系统调用 write 函数来输出，输出结果即为 flag<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfQYbn.png\" alt=\"\" /></p>\n<p>【关于 asm，给我们解释了汇编代码的含义】</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfQB2F.png\" alt=\"\" /><br />\n系统调用（int 0x80）在后面执行，系统调用号在前面</p>\n<h1 id=\"pwn6立即寻址方式\"><a class=\"anchor\" href=\"#pwn6立即寻址方式\">#</a> pwn6（立即寻址方式）</h1>\n<h2 id=\"题目-2\"><a class=\"anchor\" href=\"#题目-2\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPf1WcD.png\" alt=\"\" /><br />\n32 位程序，让我们计算立即寻址方式后的 eax 的值</p>\n<p>【立即寻址方式是一种操作数寻址方式。在立即寻址方式下，指令的地址字段指出的是操作数本身，而不是操作数的地址。立即寻址方式的特点是指令执行时间很短，因为它不需要访问内存取数，从而节省了访问内存的时间。立即寻址方式常用于指令的源操作数，不能用作目的操作数。例如，MOV AX,5678H 指令中的 5678H 就是一个立即数，作为源操作数直接参与指令的运算。】这意味着，将寄存器不会去将该值当作地址，直接看作一个数值<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPf1zHs.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov eax, 0Bh        <span class=\"token comment\">#eax=0xBh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">add</span>  eax, 1BF48h <span class=\"token comment\">#eax=eax+0x1BF48h</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sub   eax, <span class=\"token number\">1</span>             <span class=\"token comment\">#eax=eax-1</span></pre></td></tr></table></figure><p>得到 eax=0x1BF52h  (114514)</p>\n<p>所以答案 ctfshow (114514)</p>\n<p>此题 asm<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPf39Nq.png\" alt=\"\" /></p>\n<h1 id=\"pwn7寄存器寻址方式\"><a class=\"anchor\" href=\"#pwn7寄存器寻址方式\">#</a> pwn7（寄存器寻址方式）</h1>\n<h2 id=\"题目-3\"><a class=\"anchor\" href=\"#题目-3\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPf3JDH.png\" alt=\"\" /></p>\n<p>【寄存器寻址方式：操作数在 CPU 内部的寄存器中，指令指定寄存器号。，意味着直接取指定寄存器当中的值即可】</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPf3a5t.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov ebx, 36Dh  <span class=\"token comment\">#ebx=0x36Dh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mov edx, ebx     <span class=\"token comment\">#edx=ebx</span></pre></td></tr></table></figure><p 0x36D=\"\">edx=0x36Dh  (877），<br />\nctfshow</p>\n<p>【asm】<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPf3R5q.png\" alt=\"\" /></p>\n<h1 id=\"pwn8直接寻址方式\"><a class=\"anchor\" href=\"#pwn8直接寻址方式\">#</a> pwn8（直接寻址方式）</h1>\n<h2 id=\"题目-4\"><a class=\"anchor\" href=\"#题目-4\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPf3qaR.png\" alt=\"\" /></p>\n<p>【直接寻址方式：在指令中直接给出参与运算的操作数及运算结果所存放的主存地址，即在指令中直接给出有效地址。意味着直接将地址赋值给对应寄存器】</p>\n<p>32 位程序，查看汇编<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPf3XPx.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov ecx, dword_80490E8  <span class=\"token comment\">#ecx=dword_80490E8 (地址就是 0x80490E8)</span></pre></td></tr></table></figure><p 0x80490E8=\"\">ctfshow</p>\n<p>【asm】<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfrBuR.png\" alt=\"\" /></p>\n<h1 id=\"pwn9-间接寻址方式\"><a class=\"anchor\" href=\"#pwn9-间接寻址方式\">#</a> pwn9 （间接寻址方式）</h1>\n<h2 id=\"题目-5\"><a class=\"anchor\" href=\"#题目-5\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfrDD1.png\" alt=\"\" /></p>\n<p>【间接寻址方式：间接寻址是在直接寻址的基础上面建立起来的，也就是直接寻址得到的数据是一个地址，通过这个地址找到最终的数据，也就是两次寻址，第一次得到的是地址，第二次才是目标数据】</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfsnVx.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov esi,  offset dword_80490E8  <span class=\"token comment\">#esi=offset dword_80490E8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mov eax, <span class=\"token punctuation\">[</span>esi<span class=\"token punctuation\">]</span>  <span class=\"token comment\">#eax=*esi (取地址内的值，方括号意味着取该地址的值)</span></pre></td></tr></table></figure><p>利用 ida 查看其中的值</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfsBRg.png\" alt=\"\" /></p>\n<p 0x636C6557=\"\">ctfshow</p>\n<p>【asm】<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfs3xH.png\" alt=\"\" /></p>\n<h1 id=\"pwn10寄存器相对寻址方式\"><a class=\"anchor\" href=\"#pwn10寄存器相对寻址方式\">#</a> pwn10（寄存器相对寻址方式）</h1>\n<h2 id=\"题目-6\"><a class=\"anchor\" href=\"#题目-6\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPf27an.md.png\" alt=\"\" /></p>\n<p>【寄存器相对寻址方式：操作数的有效地址是一个寄存器和位移量之和。地址是寄存器 + 一个偏移值，具体值在该地址里】</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPfWmlT.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov ecx, offset dword_80490E8   <span class=\"token comment\">#ecx=dword_80490E8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">add</span>  ecx, <span class=\"token number\">4</span>   <span class=\"token comment\">#ecx=ecx+4</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mov eax, <span class=\"token punctuation\">[</span>ecx<span class=\"token punctuation\">]</span>  <span class=\"token comment\">#eax=*ecx (取该地址的值)</span></pre></td></tr></table></figure><p>eax=*(0x80490E8+4)=&quot;ome_to_CTFshow_PWN&quot;</p>\n<p ome_to_CTFshow_PWN=\"\">ctfshow</p>\n<p>【asm】<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPff3Dg.png\" alt=\"\" /></p>\n<h1 id=\"pwn11基址变址寻址方式\"><a class=\"anchor\" href=\"#pwn11基址变址寻址方式\">#</a> pwn11（基址变址寻址方式）</h1>\n<h2 id=\"题目-7\"><a class=\"anchor\" href=\"#题目-7\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPffd2V.png\" alt=\"\" /></p>\n<p>【基址变址寻址方式：操作数的有效地址是一个基址寄存器和一个变址寄存器的内容之和。一般为寄存器直接的运算在赋值】</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/16/pPffHIA.png\" alt=\"\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mov ecx, offset dword_80490E8  <span class=\"token comment\">#exc=0x80490E8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mov edx, <span class=\"token number\">2</span>   <span class=\"token comment\">#edx=2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mov dax,<span class=\"token punctuation\">[</span>exc+edx*2<span class=\"token punctuation\">]</span>  <span class=\"token comment\">#ecx=*(0x80490E8+2*2)</span></pre></td></tr></table></figure><p>ecx=&quot;ome_to_CTFshow_PWN&quot;</p>\n<p ome_to_CTFshow_PWN=\"\">ctfshow</p>\n<p>【asm】<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPf5TZF.png\" alt=\"\" /></p>\n<h1 id=\"pwn12\"><a class=\"anchor\" href=\"#pwn12\">#</a> pwn12</h1>\n<h2 id=\"题目-8\"><a class=\"anchor\" href=\"#题目-8\">#</a> 题目</h2>\n",
            "tags": [
                "pwn"
            ]
        },
        {
            "id": "https://vvwwvv.cn/2023/09/15/pwn/%E5%88%B7%E9%A2%98/ctfshow/ctfshow/",
            "url": "https://vvwwvv.cn/2023/09/15/pwn/%E5%88%B7%E9%A2%98/ctfshow/ctfshow/",
            "title": "CTFshow(Test_your_nc部分,0~4)",
            "date_published": "2023-09-15T03:01:15.000Z",
            "content_html": "<h1 id=\"pwn0\"><a class=\"anchor\" href=\"#pwn0\">#</a> pwn0</h1>\n<h2 id=\"题目\"><a class=\"anchor\" href=\"#题目\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWt1sS.png\" alt=\"\" /></p>\n<p>利用 ssh 连接，不知道为什么之前连接是失败的<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPWffpV.png\" alt=\"\" /></p>\n<p>然后输入密码会加载一大堆东西</p>\n<p>而且密码不在当前目录下需要到根目录查看</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWfLfx.png\" alt=\"\" /></p>\n<h1 id=\"pwn1\"><a class=\"anchor\" href=\"#pwn1\">#</a> pwn1</h1>\n<h2 id=\"题目-2\"><a class=\"anchor\" href=\"#题目-2\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWhgDe.md.png\" alt=\"\" /></p>\n<p>题目里已经说明有后门了，下载附件利用 ida 打开</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWhqbQ.png\" alt=\"\" /></p>\n<p>发现输出完句子之后会直接执行 cat flag，那么直接 nc 连接即可<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPWhXUs.md.png\" alt=\"\" /></p>\n<h1 id=\"pwn2\"><a class=\"anchor\" href=\"#pwn2\">#</a> pwn2</h1>\n<h2 id=\"题目-3\"><a class=\"anchor\" href=\"#题目-3\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPW4pvT.png\" alt=\"\" /></p>\n<p>下载附件查看程序信息，发现是 64 位程序<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPW4WsU.md.png\" alt=\"\" /></p>\n<p>ida 打开<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPWL4e0.png\" alt=\"\" /><br />\n发现有个 system (/bin/sh), 直接 给权限了，那么就直接可以获取 flag</p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWL7YF.png\" alt=\"\" /></p>\n<h1 id=\"pwn3\"><a class=\"anchor\" href=\"#pwn3\">#</a> pwn3</h1>\n<h2 id=\"题目-4\"><a class=\"anchor\" href=\"#题目-4\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWLLl9.png\" alt=\"\" /></p>\n<p>查看保护是 64 位程序，ida 打开<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPWLzTK.png\" alt=\"\" /></p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWOCfe.png\" alt=\"\" /></p>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWOFld.png\" alt=\"\" /></p>\n<p>这里考察我们对函数的理解</p>\n<ul>\n<li>put 函数输出的是字符串</li>\n<li>echo 主要用于打印简单的字符串和变量值</li>\n<li>cat 用来查看文件内容，更侧重于处理文件，实现文件内容的读取和拼接等操作</li>\n</ul>\n<p>(只有 system (cat /flag) 输出了 flag，选择 4 只会输出字符串”/ctfshow_flag“)<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/15/pPWOllj.png\" alt=\"\" /></p>\n<h1 id=\"pwn4\"><a class=\"anchor\" href=\"#pwn4\">#</a> pwn4</h1>\n<h2 id=\"题目-5\"><a class=\"anchor\" href=\"#题目-5\">#</a> 题目</h2>\n<p><img data-src=\"https://z1.ax1x.com/2023/09/15/pPWOonI.png\" alt=\"\" /></p>\n<p>查看程序是 64 位，用 ida 打开<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfDMex.png\" alt=\"\" /></p>\n<p><code>execve_func()</code>  里有后门<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfDlTK.md.png\" alt=\"\" /></p>\n<p><code>strcmp(str1,str2)</code>  该函数会进行比较，str1=str2 时会返回 0，所以输入 <code>CTFshowPWN</code>  以此绕过判断<br />\n<img data-src=\"https://z1.ax1x.com/2023/09/16/pPfDPe0.png\" alt=\"\" /></p>\n",
            "tags": [
                "pwn",
                "nc"
            ]
        }
    ]
}