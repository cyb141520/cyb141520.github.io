{
    "version": "https://jsonfeed.org/version/1",
    "title": "0110 0011 0111 1001 0110 0010 • All posts by \"路由器\" category",
    "description": "",
    "home_page_url": "https://vvwwvv.cn",
    "items": [
        {
            "id": "https://vvwwvv.cn/2023/09/30/pwn/%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E/DVRF%E5%AD%A6%E4%B9%A0/",
            "url": "https://vvwwvv.cn/2023/09/30/pwn/%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E/DVRF%E5%AD%A6%E4%B9%A0/",
            "title": "利用DVRF学习固件分析",
            "date_published": "2023-09-30T11:23:15.000Z",
            "content_html": "<h1 id=\"1下载dvrf与安装\"><a class=\"anchor\" href=\"#1下载dvrf与安装\">#</a> 1. 下载 DVRF 与安装</h1>\n<p>下载压缩包：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3ByYWV0b3JpYW4taW5jL0RWUkY=\">https://github.com/praetorian-inc/DVRF</span></p>\n<p>下载后解压：</p>\n<p><code>unzip DVRF-master.zip</code></p>\n<p>安装 buildroot（2016.05 版本）【搭建交叉编译环境，这里我的 ubuntu 是 22.04】</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> buildroot</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> buildroot</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wget</span> https://buildroot.org/downloads/buildroot-2016.05.tar.gz</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>https://buildroot.org/downloads/buildroot-2018.08.4.tar.gz</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>https://buildroot.org/downloads/buildroot-2022.02.tar.gz</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>https://buildroot.org/downloads/buildroot-2020.02.5.tar.gz</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">tar</span> zxf buildroot-2016.05.tar.gz</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token builtin class-name\">cd</span> buildroot-2016.05</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> ncurses-dev</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">make</span> menuconfig</pre></td></tr></table></figure><p>上面的 buildroot 版本有的不行，这里查找最符合的版本：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9idWlsZHJvb3Qub3JnL2Rvd25sb2Fkcy8=\">https://buildroot.org/downloads/</span></p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/E0UTUAXFYI_5TGVEZ4JDJVL.png\" alt=\"\" /></p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/394%253O9EOUI%7DLPHZ19B%24RAY.png\" alt=\"\" /></p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/2%5D%7BL%24C20%24Y0PAL_%60_7%28%5D%40%28N.png\" alt=\"\" /></p>\n<p>选择完成后退出，然后进入 <code>Toolchain</code></p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/J_%28S%7BN8KJL7MK%24%24R%7DF%285Z%25T.png\" alt=\"\" /></p>\n<p>设置远程 gdb 调试：</p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/AHKQMP00R2IE3Q%25%7E%7B1GS%5BKG.png\" alt=\"\" /></p>\n<p>最后输入 <code>make</code>  等待下载（）</p>\n<p>这里报错：</p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/%40%25MJA00GBQDRERR%408GDHWGQ.png\" alt=\"\" /></p>\n<p><img data-src=\"https://vvwwv.oss-cn-nanjing.aliyuncs.com/iot/N7BND%25Y%7D4L%29U3T%25DV416M1H.png\" alt=\"\" /></p>\n<h1 id=\"2使用binwalk进行固件提取\"><a class=\"anchor\" href=\"#2使用binwalk进行固件提取\">#</a> 2. 使用 binwalk 进行固件提取</h1>\n<p><code>binwalk -Me *.bin</code></p>\n<pre><code>这里参数M是进行递归提取（和 -e 或 -dd 配合）\n参数 -e 是按照预定的配置文件中的提取方法从固件中提取探测到的文件系统\n\nd参数用来限制递归提取的深度，默认深度为 8（仅有 -M时 有效） \n</code></pre>\n<p>其他参数：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d4aDAwMDBtbS9hcnRpY2xlL2RldGFpbHMvODU2ODM2NjE=\">https://blog.csdn.net/wxh0000mm/article/details/85683661</span></p>\n",
            "tags": [
                "二进制"
            ]
        },
        {
            "id": "https://vvwwvv.cn/2023/09/30/pwn/%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E/D-Link/D-Link%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/",
            "url": "https://vvwwvv.cn/2023/09/30/pwn/%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E/D-Link/D-Link%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/",
            "title": "D-Link路由器漏洞复现",
            "date_published": "2023-09-30T11:23:15.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>D-Link DIR-816 A2 是中国台湾友讯（D-Link）公司的一款无线路由器。攻击者可借助‘datetime’参数中的 shell 元字符利用该漏洞在系统上执行任意命令。</p>\n<h1 id=\"1固件及环境\"><a class=\"anchor\" href=\"#1固件及环境\">#</a> 1. 固件及环境</h1>\n<h2 id=\"测试环境ubuntu1604\"><a class=\"anchor\" href=\"#测试环境ubuntu1604\">#</a> 测试环境：Ubuntu16.04</h2>\n<h2 id=\"固件版本110b05\"><a class=\"anchor\" href=\"#固件版本110b05\">#</a> 固件版本：1.10B05</h2>\n<p>在官网查找对应版本（D-Link DIR-816 A2）<br />\n<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5kbGluay5jb20uY24vdGVjaHN1cHBvcnQv\">http://www.dlink.com.cn/techsupport/</span></p>\n<p><img data-src=\"https://img1.imgtp.com/2023/09/30/2e9n0y09.png\" alt=\"\" /></p>\n<h2 id=\"静态分析工具ida\"><a class=\"anchor\" href=\"#静态分析工具ida\">#</a> 静态分析工具：IDA</h2>\n<h2 id=\"系统文件获取binwalk\"><a class=\"anchor\" href=\"#系统文件获取binwalk\">#</a> 系统文件获取：binwalk</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1JlRmlybUxhYnMvYmlud2Fsaw==\">https://github.com/ReFirmLabs/binwalk</span></p>\n<p>在 Ubuntu16.04 中下载 <code>binwalk</code> : <code>sudo apt install binwalk</code></p>\n<h2 id=\"动态调试工具qemu-ida\"><a class=\"anchor\" href=\"#动态调试工具qemu-ida\">#</a> 动态调试工具：qemu、IDA</h2>\n<p>qemu 安装（Ubuntu22.10 下不成功）：</p>\n<pre><code>sudo apt-get install qemu\n#user mode,包含qemu-mips-static，qemu-mipsel-static,qemu-arm-static等\nsudo apt-get install qemu-user-static\n#system mode，包含qemu-system-mips，qemu-system-mipsel,qemu-system-arm等\nsudo apt-get install qemu-system\n</code></pre>\n<h1 id=\"2利用binwalk进行固件解包\"><a class=\"anchor\" href=\"#2利用binwalk进行固件解包\">#</a> 2. 利用 binwalk 进行固件解包</h1>\n<p>1. 解包：<br />\n <code>binwalk -Me DIR-816A2_FWv1.10CNB05_R1B011D88210.img</code></p>\n<p><img data-src=\"https://img1.imgtp.com/2023/09/30/cWDSxVvs.png\" alt=\"\" /></p>\n<p>查看我们解的包，发现有个 <code>squashfs-root</code> , 这就是我们需要的系统文件<br />\n<img data-src=\"https://img1.imgtp.com/2023/09/30/ZUf7rJn3.png\" alt=\"\" /></p>\n<p><img data-src=\"https://img1.imgtp.com/2023/09/30/SyfhCepg.png\" alt=\"\" /></p>\n<p>2. 查找 web 的根目录</p>\n<p>一般可以通过 <code>find -name &quot;*index*&quot;</code>  搜索出 web 的根目录在哪个具体目录下。<br />\n<img data-src=\"https://img1.imgtp.com/2023/09/30/zCKiGAqg.png\" alt=\"\" /></p>\n<p>3. 在 web 目录下执行命令 <code>file ../../bin/goahead</code> ，即可查看发现是 mips 架构，在之后的 qemu 模拟器要用 mips 方式来模拟</p>\n<p><img data-src=\"https://img1.imgtp.com/2023/09/30/AkXXt4pH.png\" alt=\"\" /></p>\n<p>第三步的 <code>goahead</code>  怎么来的具体还不目明确，有利用 nmap 扫描发现 80 端口是这个的</p>\n<p>4. 利用 qumu 来模拟<br />\n输入命令： <code>sudo qemu-mipsel -L ../../ -g 1234 ../../bin/goahead</code></p>\n<pre><code>-g 使用qemu并将程序挂载在1234端口，等待调试。\n-L 是根目录的所在的位置。\n可以使用IDA远程调试连接1234端口，进行调试，获取使用gdb也可以调试。\n</code></pre>\n<p>5. 利用 IDA 进行调试</p>\n<p>找到源程序来利用 gdb 查看这里查看发现是 <code>mips-32-little</code> , 保护全没开<br />\n<img data-src=\"https://img1.imgtp.com/2023/09/30/OqAkTic7.png\" alt=\"\" /></p>\n<p>本来想用远程调试，但是连接失败了，只好找到源程序来手动托入 IDA 打开（32 位程序）</p>\n",
            "tags": [
                "二进制"
            ]
        }
    ]
}